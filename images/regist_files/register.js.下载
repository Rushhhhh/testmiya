function ag_635532_pvkl_ats101(){var e=""!=getcookie("miauid")?getcookie("miauid"):0;_agt=[],_agt.push(["_atscu","AG_635532_PVKL"]),_agt.push(["_atsdomain","miyabaobei.com"]),_agt.push(["_atsev","101"]),_agt.push(["_atsusr",e]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https":"http")+"://t.agrantsem.com/js/ag.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()}function track(){_adwq.push(["_setAction","7p32ud",$("#login_username").val()]);var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https":"http")+"://d.emarbox.com/js/adw_miya.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}function doReg(){if(checkRegisterForm()&&checkAuthCode()){$("#register_submit").unbind("click");var e=$("#url").val();""!=e&&"undefined"!=typeof e||(e="/"),$.ajax({type:"POST",url:"/instant/account/registerService",dataType:"json",data:$("#register_form").serialize(),success:function(t){if(1==t.code){if(t.synlogin&&t.synlogin)for($i=0;$i<t.synlogin.length;$i++){var n=document.createElement("iframe");n.style.display="none",n.src=""+t.synlogin[$i],document.body.appendChild(n)}setTimeout(function(){tprm="uid99="+$("#login_username").val(),ag_635532_pvkl_ats101(),track(),window.location.href=e},2e3)}else{if($("#register_verified_code").attr("src","/account/login/authcode/"+Math.random()),t.code==-1){var i=$(".tipauthcode");i.find(".tipcon").text(t.msg).show(),i.show()}else t.code==-2?(_refreshTCode(),$("#sendVerifyCode").parent().parent().find("p").removeClass("usermassge").addClass("usermassge1").html(getTipHtml(t.msg,"")).show()):$("#confirm_password").parent().parent().find("p").html(getTipHtml(t.msg,"")).show();$("#register_submit").click(function(){doReg()})}}})}else $("#register_submit").toggleClass("shake-horizontal shake"),setTimeout("removeShake()",500);return!1}function removeShake(){$("#register_submit").toggleClass("shake shake-horizontal")}function checkAuthCode(){return!0}function checkUsername(e){$(".noticWrap p").empty().hide();var t=$("#login_username").val();$.ajax({type:"POST",url:"/instant/account/checkForCell",data:"cell="+t,dataType:"json",success:function(e){return 1==e.code?($("#login_username").parent().parent().find("p").html(getTipHtml("此手机号已被占用","")).show(),!1):($("#login_username").parent().parent().find("p").empty().hide(),!0)}})}function checkRegisterForm(){var e=verifyUsername(),t=verifyPhonecode(),n=verifyPassword(),i=verifyConfirmPassword(),r=verifyAgree();return!!e&&(!!t&&(!!n&&(!!i&&(!!r&&($.bt_validate.result=!0,$.bt_validate.form.find("input[validate],select[validate],textarea[validate]").trigger("blur"),!$.bt_validate.blocked&&$.bt_validate.result)))))}function _refreshTCode(){USE_TENCENT&&(capRefresh(),$("#authcode").val(""))}function sendMessage(e){curCount=count;for(var t=$("#authcode").val(),n=$(".tipauthcode"),i=$(".tipauthcode .tipcon"),r=0;r<codeLength;r++)code+=parseInt(9*Math.random()).toString();$.ajax({type:"POST",dataType:"json",url:"/instant/account/getMobileVerifyCode",data:"code="+code+"&cell="+e+"&authcode="+t,success:function(e){var t="";2==e.code?"undefined"!=typeof e.is_t?(_refreshTCode(),n.show(),i.text(e.msg).show(),setTimeout(function(){n.hide()},3e3)):(n.show(),i.text(e.msg).show(),$("#register_verified_code").attr("src","/account/login/authcode")):1==e.code?($("#sendVerifyCode").text(curCount+"秒后重新获取"),$("#sendVerifyCode").unbind(),InterValObj=window.setInterval(SetRemainTime,1e3),t="tipmessagebg",$("#sendVerifyCode").parent().parent().find("p").removeClass("usermassge1").addClass("usermassge").html(getTipHtml(e.msg,t)).show()):(window.clearInterval(InterValObj),$("#sendVerifyCode").text("重新发送短信验证码"),bindSendMobileVerifyCode(),$("#login_username").parent().parent().find("p").html(getTipHtml(e.msg,t)).show())}})}function SetRemainTime(){0==curCount?(window.clearInterval(InterValObj),$("#verifyPart .sendCode").attr("id","sendVerifyCode"),$("#sendVerifyCode").text("重新发送短信验证码"),bindSendMobileVerifyCode(),code=""):(curCount--,$("#sendVerifyCode").text(curCount+"秒后重新获取"))}function bindSendMobileVerifyCode(){var e=$(".tipauthcode"),t=e.find(".tipcon");e.hide(),t.text("").hide(),$("#sendVerifyCode").bind("click",function(n){n.preventDefault();var i=$("#login_username"),r=$.trim(i.val());if(!/^((13[0-9])|(15[0-9])|(14[5-7])|(166)|(17[0-9])|(18[0-9])|(19[8-9]))\d{8}$/.test(r)){var o="请输入正确的手机号码，且为11位纯数字格式";return i.parent().parent().find("p").html(getTipHtml(o,"")).show(),!1}var a=$("#authcode").val();if(!a){if(e.attr("is_t")){var s=$(".tencent_tip");return s.find(".tipcon").html("请点击完成验证").show(),s.show(),setTimeout(function(){s.hide()},3e3),!1}return e.show(),t.text("验证码不能为空").show(),!1}sendMessage(r)})}function getTipHtml(e,t){var n="tipnamebg";t&&(n=t);var i='<span  class="tipcon">'+e+"</span>";return i+='<span class="rownotice"><img src="/resources/images/'+n+'.png"></span>'}function verifyUsername(){var e=$("#login_username"),t=$.trim(e.val());if(/^((13[0-9])|(15[0-9])|(14[5-7])|(166)|(17[0-9])|(18[0-9])|19([8-9]))\d{8}$/.test(t))return!0;var n="请输入正确的手机号码，且为11位纯数字格式";return e.parent().parent().find("p").html(getTipHtml(n,"")).show(),!1}function verifyPhonecode(){if(USE_TENCENT)return!0;var e=$("#phonecode"),t=$.trim(e.val());return!!t||($("#sendVerifyCode").parent().parent().find("p").removeClass("usermassge").addClass("usermassge1").html(getTipHtml("短信验证码不能为空","")).show(),!1)}function verifyPassword(){var e=$("#login_password"),t=!0;return(e.val().length<6||e.val().length>14)&&(e.parent().siblings("p").html(getTipHtml("长度为6-14个字符，建议使用字母加数字或符号组合","")).show(),t=!1),t}function verifyConfirmPassword(){var e=$("#login_password"),t=$("#confirm_password"),n=!0;return(t.val().length<6||t.val().length>14)&&(t.parent().siblings("p").html(getTipHtml("长度为6-14个字符，建议使用字母加数字或符号组合","")).show(),n=!1),e.val()!=t.val()&&(t.parent().siblings("p").html(getTipHtml("两次输入的密码不一致","")).show(),n=!1),n}function verifyAgree(){return $("#isagree").attr("checked")?($("#isagree").siblings("p").hide(),!0):($("#isagree").siblings("p").show(),!1)}$.bt_validate.method("pass_eq",function(e){return $("#login_password").val()==$("#confirm_password").val()},"两次输入的密码不一致"),$("#register_form").bt_validate(),$(document).ready(function(){$("#register_submit").click(function(e){doReg(),e.preventDefault()}),$("#register_verified_code,#register_verified_refresh").click(function(e){e.preventDefault(),$("#register_verified_code").attr("src","/account/login/authcode/"+Math.random())}),$("#login_username").bind({blur:function(){verifyUsername()},focus:function(){$("#login_username").parent().siblings("p").hide()}}),$("#login_username").change(function(){$("#register_verified_code").attr("src","/account/login/authcode/"+Math.random())}),$("#phonecode").bind({blur:function(){verifyPhonecode()},focus:function(){$("#sendVerifyCode").parent().siblings("p").hide()}}),$("#authcode").bind({blur:function(){},focus:function(){$(".tipauthcode").hide(),$(".tipphonecode").hide()}}),$("#login_password").bind({blur:function(){verifyPassword()},focus:function(){return $(this).parent().siblings("p").hide(),!0}}),$("#confirm_password").bind({blur:function(){verifyConfirmPassword()},focus:function(){return $(this).parent().siblings("p").hide(),!0}}),$("#isagree").bind({click:function(){verifyAgree()}}),bindSendMobileVerifyCode()});var _agt=_agt||[],tprm="",InterValObj,count=60,curCount,code="",codeLength=4;